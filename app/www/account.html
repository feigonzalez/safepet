<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ajustes - SafePet</title>
    <link rel="stylesheet" href="assets/style.css">
    <script src="assets/app.js"></script>
    <script src="assets/db.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #FFFFFF;
            color: #333333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: #FFFFFF;
            padding: 24px;
            border-bottom: 1px solid #E0E0E0;
            display: flex;
            align-items: center;
            gap: 16px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .back-button {
            background: none;
            border: none;
            padding: 4px;
            cursor: pointer;
            border-radius: 6px;
            transition: background-color 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
        }

        .back-button:hover {
            background-color: #F5F5F5;
        }

        .back-button svg {
            width: 20px;
            height: 20px;
            stroke: #333333;
            stroke-width: 2;
        }

        .header-title {
            font-size: 28px;
            font-weight: 700;
            color: #333333;
        }

        .settings-container {
            flex: 1;
            padding: 32px 24px;
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
        }

        .settings-card {
            background: #FFFFFF;
            border-radius: 16px;
            box-shadow: 0 4px 14px 0 rgba(0, 0, 0, 0.08);
            overflow: hidden;
            margin-bottom: 24px;
        }

        .settings-item {
            display: flex;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #E0E0E0;
            cursor: pointer;
            transition: background-color 0.2s ease;
            text-decoration: none;
            color: inherit;
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-item:hover {
            background-color: #F5F5F5;
        }

        .settings-item.logout:hover {
            background-color: rgba(239, 68, 68, 0.05);
        }

        .settings-icon {
            width: 24px;
            height: 24px;
            margin-right: 16px;
            flex-shrink: 0;
        }

        .settings-icon.profile {
            stroke: #2DBBAD;
            fill: none;
            stroke-width: 2;
        }

        .settings-icon.pets {
            stroke: #2DBBAD;
            fill: none;
            stroke-width: 2;
        }

        .settings-icon.logout {
            stroke: #EF4444;
            fill: none;
            stroke-width: 2;
        }

        .settings-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .settings-title {
            font-size: 16px;
            font-weight: 600;
            color: #333333;
            margin-bottom: 4px;
        }

        .settings-description {
            font-size: 14px;
            font-weight: 400;
            color: #828282;
        }

        .settings-item.logout .settings-title {
            color: #EF4444;
        }

        .settings-arrow {
            width: 20px;
            height: 20px;
            stroke: #828282;
            stroke-width: 2;
            flex-shrink: 0;
        }

        .profile-section {
            text-align: center;
            margin-bottom: 32px;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #2DBBAD 0%, #1a9d8f 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            box-shadow: 0 4px 14px 0 rgba(45, 187, 173, 0.3);
        }

        .profile-avatar-text {
            font-size: 32px;
            font-weight: 700;
            color: #FFFFFF;
        }

        .profile-name {
            font-size: 24px;
            font-weight: 700;
            color: #333333;
            margin-bottom: 8px;
        }

        .profile-email {
            font-size: 16px;
            font-weight: 400;
            color: #828282;
        }

        .version-info {
            text-align: center;
            padding: 24px;
            color: #828282;
            font-size: 14px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 16px 20px;
            }

            .header-title {
                font-size: 24px;
            }

            .settings-container {
                padding: 24px 20px;
            }

            .settings-item {
                padding: 16px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="row header">
        <button id="backButton" class="column compact"><span class="icon" data-icon="chevron-left"></span></button>
        <h1>Ajustes</h1>
    </div>

    <div class="settings-container">
        <!-- Sección de perfil -->
        <div class="profile-section">
            <div class="profile-avatar">
                <span class="profile-avatar-text" id="profileInitials">FE</span>
            </div>
            <div class="profile-name" id="profileName">Francisca Espinosa</div>
            <div class="profile-email" id="profileEmail">fran@example.com</div>
        </div>

        <!-- Opciones de configuración -->
        <div class="settings-card">
            <a href="editProfile.html" class="settings-item">
                <svg class="settings-icon profile" viewBox="0 0 24 24">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                    <circle cx="12" cy="7" r="4"/>
                </svg>
                <div class="settings-content">
                    <div class="settings-title">Editar Perfil</div>
                    <div class="settings-description">Actualiza tu información personal</div>
                </div>
                <svg class="settings-arrow" viewBox="0 0 24 24" fill="none">
                    <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>

            <a href="petList.html" class="settings-item">
                <svg class="settings-icon pets" viewBox="0 0 24 24">
                    <path d="M11.25 4.533a9.707 9.707 0 0 0 6.853 2.842c.75 0 1.5-.05 2.25-.15a1.5 1.5 0 0 1 1.5 1.5v7.5a1.5 1.5 0 0 1-1.5 1.5h-6.853a9.707 9.707 0 0 0-6.853-2.842c-.75 0-1.5.05-2.25.15a1.5 1.5 0 0 1-1.5-1.5v-7.5a1.5 1.5 0 0 1 1.5-1.5h6.853z"/>
                    <path d="M12 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                    <path d="M18 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                </svg>
                <div class="settings-content">
                    <div class="settings-title">Mis Mascotas</div>
                    <div class="settings-description">Gestiona la información de tus mascotas</div>
                </div>
                <svg class="settings-arrow" viewBox="0 0 24 24" fill="none">
                    <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>

            <div class="settings-item logout" onclick="confirmLogout()">
                <svg class="settings-icon logout" viewBox="0 0 24 24">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                    <polyline points="16,17 21,12 16,7"/>
                    <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
                <div class="settings-content">
                    <div class="settings-title">Cerrar Sesión</div>
                    <div class="settings-description">Salir de tu cuenta SafePet</div>
                </div>
                <svg class="settings-arrow" viewBox="0 0 24 24" fill="none">
                    <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
        </div>

        <div class="version-info">
            SafePet v1.0.0
        </div>
    </div>

    <script>
        async function beforeLoad() {
            try {
                // Cargar información del usuario
                let db = await selectAll();
                let account = db ? db.account : null;
                
                // Datos de prueba si no hay cuenta configurada
                if (!account) {
                    account = {
                        name: "Juan Pérez",
                        email: "juan.perez@email.com"
                    };
                }
                
                // Actualizar información del perfil
                updateProfileInfo(account);
            } catch (error) {
                console.log('Error loading data, using default values:', error);
                // Usar datos por defecto en caso de error
                const defaultAccount = {
                    name: "Francisca Espinosa",
                    email: "fran@example.com"
                };
                updateProfileInfo(defaultAccount);
            }
        }
        
        function updateProfileInfo(account) {
            const profileName = document.getElementById('profileName');
            const profileEmail = document.getElementById('profileEmail');
            const profileInitials = document.getElementById('profileInitials');
            
            if (profileName) profileName.textContent = account.name || 'Usuario';
            if (profileEmail) profileEmail.textContent = account.email || 'Sin correo';
            
            // Generar iniciales
            if (profileInitials && account.name) {
                const initials = account.name
                    .split(' ')
                    .filter(Boolean)
                    .map(n => n[0])
                    .slice(0, 2)
                    .join('')
                    .toUpperCase();
                profileInitials.textContent = initials || 'U';
            }
        }

        function goBack() {
            // Navegar de vuelta a la página anterior o al índice
            if (window.history.length > 1) {
                window.history.back();
            } else {
                window.location.href = 'index.html';
            }
        }

        function confirmLogout() {
            if (confirm('¿Estás seguro de que quieres cerrar sesión?')) {
                logout();
            }
        }

        function logout() {
            // Limpiar datos de sesión
            localStorage.clear();
            sessionStorage.clear();
            
            // Redirigir a la página de autenticación
            window.location.href = 'auth.html';
        }

        // Cargar datos al inicializar la página
        document.addEventListener('DOMContentLoaded', beforeLoad);
    </script>
</body>
</html>